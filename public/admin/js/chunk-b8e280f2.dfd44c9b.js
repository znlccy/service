(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8e280f2"],{"479c":function(t,e,a){},"7ffa":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Divider",{attrs:{orientation:"left"}},[t._v("列表筛选")]),a("Row",{staticClass:"search"},[a("Form",{attrs:{inline:"",model:t.formData,"label-width":80}},[a("FormItem",{attrs:{label:"合同 id"}},[a("Input",{staticClass:"filter-input",attrs:{placeholder:"请输入合同id"},model:{value:t.formData.id,callback:function(e){t.$set(t.formData,"id",e)},expression:"formData.id"}})],1),a("FormItem",{attrs:{label:"合同编号"}},[a("Input",{staticClass:"filter-input",attrs:{placeholder:"请输入合同编号"},model:{value:t.formData.contract_no,callback:function(e){t.$set(t.formData,"contract_no",e)},expression:"formData.contract_no"}})],1),a("FormItem",{attrs:{label:"合同名称"}},[a("Input",{staticClass:"filter-input",attrs:{placeholder:"请输入合同名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("Select",{staticClass:"filter-input",model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[a("Option",{attrs:{label:"待审核",value:0}}),a("Option",{attrs:{label:"待签署",value:1}}),a("Option",{attrs:{label:"已签署",value:2}}),a("Option",{attrs:{label:"即将失效",value:3}})],1)],1)],1)],1),a("div",{staticClass:"filter-btn"},[a("span",{staticClass:"span"},[t._v("操作 ")]),a("Button",{staticStyle:{"font-weight":"bold"},attrs:{type:"info",icon:"ios-search"},on:{click:function(e){t.loadData(1)}}},[t._v(" 搜索")]),a("Button",{staticStyle:{"font-weight":"bold"},attrs:{type:"warning",icon:"md-refresh"},on:{click:function(e){t.ref()}}},[t._v("重置")])],1),a("Divider",{attrs:{orientation:"left"}},[t._v("列表数据")]),a("Table",{attrs:{stripe:"",border:"",columns:t.columns,data:t.listData.data}}),t.load?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),t.listData.last_page>1?a("Row",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("Page",{attrs:{total:t.listData.total,"page-size":t.listData.per_page,current:t.listData.current_page,size:"small"},on:{"on-change":t.loadData}})],1):t._e(),a("Modal",{attrs:{title:"签署合同 "+t.selectItem.contract_no},on:{"on-ok":t.signedData,"on-cancel":t.cancel},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[a("div",[t._v("签署日期\n      "),a("DatePicker",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{type:"date",placeholder:"Select date"},model:{value:t.selectItem.sign_date,callback:function(e){t.$set(t.selectItem,"sign_date",e)},expression:"selectItem.sign_date"}})],1),a("Row",{staticStyle:{"margin-top":"20px"}},[a("Col",{attrs:{span:4}},[t._v("\n        扫描件(图片)\n      ")]),a("Col",{attrs:{span:12}},[a("image-select",{model:{value:t.selectItem.picture,callback:function(e){t.$set(t.selectItem,"picture",e)},expression:"selectItem.picture"}})],1)],1)],1)],1)},i=[],o=(a("cadf"),a("551c"),a("097d"),a("bc7a")),s=a("c2c2"),l=a("bc3a"),r={components:{ImageSelect:s["a"]},data:function(){var t=this;return{formData:{},modal:!1,load:!1,space:[],picture:null,listData:{},selectItem:{},columns:[{title:"id",align:"center",key:"id"},{title:"合同编号",align:"center",key:"contract_no"},{title:"订单号",align:"center",render:function(t,e){return t("a",{attrs:{href:"#/order/"+e.row.order.id}},e.row.order.order_no)}},{title:"合同模板",align:"center",key:"contract_no"},{title:"创建人",align:"center",render:function(t,e){return t("span",e.row.operator.nickname)}},{title:"合同开始时间",align:"center",key:"begin_time"},{title:"合同结束时间",align:"center",key:"end_time"},{title:"状态",key:"status",align:"center",render:function(t,e){return t("span",0===e.row.status?"待审核":1===e.row.status?"待签署":2===e.row.status?"已签署":"即将失效")}},{title:"Action",width:200,align:"center",render:function(e,a){return e("div",[e("Button",{props:{size:"small"},style:{marginLeft:"5px"},on:{click:function(){t.downOrder(a.row.id)}}},"下载"),e("Button",{props:{size:"small"},style:{marginLeft:"5px",display:1===a.row.status?"inline":"none"},on:{click:function(){t.signed(a.row)}}},"确认签署")])}}]}},activated:function(){this.loadData()},methods:{downOrder:function(t){l["request"]({url:"http://service.fh.81youxi.com/admin/contract/download?id="+t,method:"POST",headers:{"access-token":this.$store.state.user.admin_token},responseType:"arraybuffer"}).then(function(t){if(200===parseInt(t.data.code)){var e=new Blob([t.data],{type:""}),a=URL.createObjectURL(e);window.location.href=a}}).catch(function(t){})},loadData:function(t){var e=this;t&&(this.formData.jump_page=t),this.load=!0,o["a"].index(this.formData,function(t){e.listData=t.data.data,e.load=!1},function(){e.load=!1})},ref:function(){this.formData={},this.loadData(1)},signedData:function(){var t=this,e={id:this.selectItem.id};e.sign_date=this.$formUtil.dataToStr(this.selectItem.sign_date),e=this.$formUtil.objToFormData(e),null!=this.selectItem.picture?(e.append("scan",this.selectItem.picture),o["a"].signing(e,function(e){t.cancel(),t.$Message.success("已签署"),setTimeout(function(){t.loadData()},500)})):this.$Message.error("请选择扫描件")},cancel:function(){this.modal=!1,this.selectItem=null},signed:function(t){this.modal=!0,this.selectItem=t}}},c=r,u=(a("dc9e"),a("2877")),d=Object(u["a"])(c,n,i,!1,null,"36908475",null);d.options.__file="index.vue";e["default"]=d.exports},bc7a:function(t,e,a){"use strict";a.d(e,"a",function(){return s});var n=a("c665"),i=a("aa9a"),o=a("4a2d"),s=function(){function t(){Object(n["a"])(this,t)}return Object(i["a"])(t,null,[{key:"index",value:function(t,e,a){o["a"].request(this.uri()+"index",e,a,t)}},{key:"detail",value:function(t,e,a){o["a"].request(this.uri()+"detail",e,a,t)}},{key:"download",value:function(t,e,a){o["a"].request(this.uri()+"download",e,a,t)}},{key:"collect",value:function(t,e,a){o["a"].request(this.uri()+"collect",e,a,t)}},{key:"signing",value:function(t,e,a){o["a"].request(this.uri()+"signing",e,a,t)}},{key:"uri",value:function(){return o["a"].url()+"contract/"}}]),t}()},dc9e:function(t,e,a){"use strict";var n=a("479c"),i=a.n(n);i.a}}]);
//# sourceMappingURL=chunk-b8e280f2.dfd44c9b.js.map